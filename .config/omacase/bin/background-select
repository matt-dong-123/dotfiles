#!/usr/bin/env -S bash -l

wallpaper=$(realpath "$HOME/.config/omacase/current/theme/backgrounds")
fzf_args=(
    --preview "$HOME/.config/bin/fzf-preview.sh $wallpaper/{}"
    --border-label ' ï€¾ Backgrounds '
    --no-multi
)

selection=$(fd --type f --max-depth 1 --exec basename {} \; . "$wallpaper" | fzf "${fzf_args[@]}")

if [[ -n "$selection" ]]; then
    osascript -e "tell application \"System Events\" to set picture of every desktop to POSIX file \"$wallpaper/$selection\""
fi
