#!/usr/bin/env bash

copy=false
if [[ $1 == "--copy" ]] || [[ $1 == "-c" ]]; then
	copy=true
	shift
fi

if [[ $# -eq 0 ]]; then
	NETWORK=$(networksetup -listpreferredwirelessnetworks en0 | sed -n '2 p' | tr -d '\t')
elif [[ $# -ne 1 ]]; then
	>&2 echo "usage: $0 [-c|--copy] [wifi-network]"
	exit 1
else
	NETWORK="$1"
fi

if $copy; then
	security find-generic-password -wa "$NETWORK" | pbcopy
else
	security find-generic-password -wa "$NETWORK"
fi
